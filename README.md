# Ecwid test task

## Run

```
docker-compose up --build
```

## Requires

 - docker
 - docker-compose

## Writing Task

### Техническое задание к системе купонов

Система дает возможность покупателям получать ваучеры за заказы, которые удовлетворяют условиям акции. Система включает в себя рекламную интеграцию в виде банера в магазине, выдачу ваучера при заказе и применения при новом заказе.

#### Этапы разработки

1. Проектирование и реализация хранения купонов, акций и сопутствущей информации (5-7 часов)

Развернуть REST API сервер для последующего применения.

Необходимо реализовать (read/update/delete) модель для купонов и связать ее с акцией и ваучером. Купоны содержат дату создания:
 - ссылка на акцию;
 - код на ваучер;
 - ссылка на пользователя (если купон индивидуальный).

Необходимо реализовать (read/update/delete) модель для акции. Акция содержит:
 - дату создания;
 - дату окончания;
 - ссылку на баннер;
 - описание;
 - тип (для новых пользователей или для всех);
 - шаблон электронной почты;
 - список товаров при покупке которых выдается купон.

2. Размещение рекламного баннера на сайте (2-4 часа)

Реализовать получение данных только об актуальных акциях из бд. Сверстать рекламмный баннер в соответствии с ТЗ. Разместить рекламный баннер на странице магазина.

3. Реализация выдачи ваучере (2-4 часа)

Используя API при оформление заказа получать:
 - список товаров заказа;
 - количество заказов пользователя.
Произвести проверку в соответствии с условиями акции, а именно проверить:
 - заказ был первым у пользователя;
 - имелись товары из списка акций.
После успешного оформления заказа сформировать новый купон и сохранить его. Так же подготовить email письмо и отправить его пользователю.

[API добавить купон](https://api-docs.ecwid.com/reference/create-discount-coupon);
[API поиск заказов](https://api-docs.ecwid.com/reference/search-orders);
[API обработки запроса на скидки](https://api-docs.ecwid.com/reference/process-discount-request);

4. Реализовать применение купонов (3-5 часов)

Реализовать на странице оформления заказа возможность ввести и применить купон. После ввода пользователем купона необходимо провести валидацию. Проверить:
 - существует ли купон;
 - если индивидуальный, то проверить тот ли это пользователь;
 - проверить количество покупок пользователя (должна быть только одна);
 - проверить не истек ли купон.

[API поиск заказов](https://api-docs.ecwid.com/reference/search-orders);
[API обработки запроса на скидки](https://api-docs.ecwid.com/reference/process-discount-request);
[API поиск купонов](https://api-docs.ecwid.com/reference/search-discount-coupons);

Если валидация прошла успешна, изменить цену заказа.

5. Административная страница (10-12 часов)

Административная страница должна соответствовать единому стилю. Она должна включать в себя:
 - включение и отключение системы;
 - выводить в табличном виде списка всех существующших купонов с указание статуса, возможностью сортировки по статусу, дате создания, дате окончания;
    - по нажатию на купон появляется вся доступная информация о купоне;
    - купон можно удалить;
    - у купона можно изменить дату окончания;
 - выводить в табличном виде всех акций, с возможностью сортировки по дате создания, дате окончания;
    - по нажатию на акцию появляется вся доступная информация о ней;
    - акцию можно удалить;
    - у акции можно изменить дату окончания;
    - изменить шаблон email (используя например [CKEditor](https://github.com/ckeditor/ckeditor5));
 - добавить кнопку создания новой акции по кнопке;
    - по нажатию на кнопку открывается форма создания новой акции;
    - возможность создания шаблона email используя доступный редактор;
    - возможность указания даты окончания;
    - возможность добавить изображение на баннер;
    - возможность добавить описание (уточнить);
    - возможность добавить тип (для новых пользователей или для всех);
    - возможность выбрать список товаров при покупке которых выдается купон

#### Возможные проблемы

 - Брутфорс купонов (необходимо ограничить возможность попытки применения купонов)
 - Переполнение бд большим количеством ранее созданных и истекших купонов (возможна очистка истекших купонов)
 - Мультиаккаунт
